import{_ as N,z as L,a as E,j as b,A as R,h as V,I as q,r as v,J as B,o as i,c as a,b as n,t as w,l as T,p as m,m as f,F as C,e as D,f as j,s as F,x as H}from"./index-e04ed277.js";import{_ as M,T as P}from"./SoftToggle-983e8759.js";import{L as U}from"./LoadingRoller-20aecab2.js";const y=l=>(F("data-v-7cc303ff"),l=l(),H(),l),Y={class:"content-wrap"},z={class:"search-result"},A={class:"option-control__activate"},J=y(()=>n("span",null,"모집 중만 보기",-1)),$={class:"meetings"},G={key:0,class:"result-none"},K={class:"search-keyword"},Q=y(()=>n("p",null,"검색할 단어를 변경하거나, 검색어를 확인해주세요.",-1)),W={class:"loading-wrap"},X={__name:"Search",emits:["throw"],setup(l,{emit:S}){const r=L().query.q,t=E({meetings:[],lastId:null,throttling:null,loadingOn:!1,isToggleOn:!0,isResultNone:b(()=>t.meetings.length===0)});R(()=>t.isToggleOn,async()=>{t.lastId=null;const e=await c();I(),!(!e||e.length===0)&&u(e)});function O(e){e.target.tagName!=="INPUT"&&e.target.type!=="checkbox"||(t.isToggleOn=!t.isToggleOn)}c().then(e=>{!e||e.length===0||u(e)});async function c(){try{const e=await V.meeting.getThumbnailList(k(t));if(!e.ok)throw new q(e);return await e.json()}catch(e){console.log(e),e.res.status===500&&S("throw")}}function I(){t.meetings=[]}function u(e){for(const s of e)t.meetings.push(s)}function k(e){const s={};return e.isToggleOn&&(s.isClosed=!1),e.lastId&&(s.start=e.lastId),s.keyword=r,s}const g=v(0),d=v(0);function p(e){if(t.meetings===0)return;const s=window.scrollY;s>d.value?g.value=-1:s<d.value&&(g.value=1),d.value=s;const{scrollHeight:o,scrollTop:_,clientHeight:x}=document.documentElement;!t.throttling&&_+x>o-5&&g.value<0&&(t.loadingOn=!0,t.throttling=setTimeout(async()=>{t.throttling=null,t.loadingOn=!1,t.lastId=t.meetings[t.meetings.length-1].id;const h=await c();!h||h.length===0||u(h)},300))}return document.addEventListener("scroll",p),B(()=>{document.removeEventListener("scroll",p)}),(e,s)=>(i(),a("div",Y,[n("div",z,[n("h2",null,[n("strong",null,w(T(r)),1),m(" 검색결과 ")])]),n("div",A,[J,f(M,{onClick:s[0]||(s[0]=o=>O(o)),isOn:t.isToggleOn},null,8,["isOn"])]),n("section",$,[n("ul",null,[(i(!0),a(C,null,D(t.meetings,(o,_)=>(i(),a("li",{key:_},[f(P,{meeting:o},null,8,["meeting"])]))),128))]),t.isResultNone?(i(),a("div",G,[n("p",null,[m(" '"),n("strong",K,w(T(r)),1),m("'에 대한 검색 결과가 없어요 ! ")]),Q])):j("",!0)]),n("div",W,[f(U,{isShow:t.loadingOn},null,8,["isShow"])])]))}},ne=N(X,[["__scopeId","data-v-7cc303ff"]]);export{ne as default};
