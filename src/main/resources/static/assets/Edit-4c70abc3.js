import{_ as O,u as j,a as A,r as k,o as a,c as s,l as p,D as y,n as m,b as t,V as M,f as N,t as x,C as F,g as K,q as Y,w as Z,F as q,h as H,s as G,x as J,m as Q}from"./index-e04ed277.js";import{M as W}from"./Default-9bfb2fe8.js";import{M as $}from"./Changed-7f5a0ef7.js";const h=_=>(G("data-v-1489ec30"),_=_(),J(),_),X=h(()=>t("p",null,"ë‹‰ë„¤ìž„ì€ 30ì¼ì— í•œ ë²ˆë§Œ ë³€ê²½ê°€ëŠ¥í•´ìš”.",-1)),ee=h(()=>t("p",{class:"confirm"},"ì •ë§ ë³€ê²½í•˜ì‹œê² ì–´ìš” ?ðŸ˜¶",-1)),ne={key:0,class:"confirm"},te={key:1,class:"confirm"},oe={key:2,class:"confirm"},ie={key:3,class:"confirm"},ae={class:"confirm"},se=h(()=>t("p",{class:"confirm"},"ì´ë¯¸ì§€ë³€ê²½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",-1)),le={class:"my-profile"},ce={class:"my-profile-container"},re=h(()=>t("h2",{class:"profile__title"},"í”„ë¡œí•„ ìˆ˜ì •",-1)),pe={class:"profile__image"},ue={key:0,class:"profile__image--with-photo"},de=["src"],me={key:1,class:"profile__image--no-photo"},_e={class:"input-text"},fe=h(()=>t("label",{class:"input-text__label",for:"input-text__content"},null,-1)),ge=["placeholder"],ke=["textContent"],he=["onClick"],ve={__name:"ProfileEdit",setup(_){const l=j(),w=l.nickname,o=A({inputMessage:"",isNicknameValid:null,inputNickname:""});let u=k(!1),f=k(!1),g=k(!1);const c=A({nicknameConfirm:null,imageConfirm:null});let v;const V=k(null),C=k(""),P=()=>{let e;e&&clearTimeout(e),e=setTimeout(function(){T(o.inputNickname)},300)};function T(e){if(console.log(e),e.length===0)return;if(!/^(?=.*[a-zA-Z0-9ê°€-íž£])[a-zA-Z0-9ê°€-íž£]{0,10}$/.test(e)){o.inputMessage="ë‹‰ë„¤ìž„ì€ í•œê¸€, ìˆ«ìž, ì˜ì–´ë§Œ ì¡°í•©í•´ì£¼ì„¸ìš”!",o.isNicknameValid=!1;return}const i=new FormData;i.append("nickname",e),fetch("/api/nickname/validation",{method:"POST",body:i}).then(r=>{if(r.ok)return r.json();throw Error()}).then(r=>{let D=r.result;if(console.log(r),D==="NICKNAME_VALID"){o.inputMessage="ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ë‹‰ë„¤ìž„ì´ì—ìš”!",o.isNicknameValid=!0;return}if(D=="NICKNAME_ALREADY_USED"){o.inputMessage="ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ë‹‰ë„¤ìž„ì´ì—ìš”!",o.isNicknameValid=!1;return}}).catch(r=>{console.log(r)})}function E(e){V.value.click()}function U(e){v=e.target.files[0];const n=new FileReader;n.readAsDataURL(v),n.onload=function(i){C.value=i.target.result,c.imageConfirm=!0}}function I(){u.value=!0}function B(){u.value=!1}function S(){f.value=!0}function R(){g.value=!0}function z(){console.log("ë‹‰ë„¤ìž„ë³€ê²½ì„í•˜ê² ë°ìš”"),B();const e=new FormData;e.append("nickname",o.inputNickname),fetch("/api/me/edit",{method:"POST",body:e}).then(d=>{d.ok?(console.log("ë‹‰ë„¤ìž„ ë³€ê²½ ìš”ì²­ í™•ì¸"),l.nickname=o.inputNickname,console.log(l.nickname+"ë³€ê²½í›„"),c.nicknameConfirm=!0,S(),H.auth.me()):(c.nicknameConfirm=!1,console.log("30ì¼ ì´ë‚´ì—ëŠ” ë‹‰ë„¤ìž„ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤."),S())})}function b(){console.log("ì´ë¯¸ì§€ ë³€ê²½ ìš”ì²­");const e=new FormData;console.log("file ì •ë³´"),console.log(v),e.append("file",v),e.append("path","/image/profile"),fetch("/api/upload/profile",{method:"POST",body:e}).then(d=>d.json()).then(d=>{console.log("ì´ë¯¸ì§€ìš”ì²­ ì™„ë£Œ!"),console.log(d),R()})}function L(){const e=o.isNicknameValid,n=c.imageConfirm;if(n==!0&&e==!0){I(),b();return}if(n==!0&&!e){b();return}e==!1&&(o.inputMessage="ìœ íš¨í•˜ì§€ ì•Šì€ ë‹‰ë„¤ìž„ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ì—†ì–´ìš”!"),e==!0&&I(),console.log("nothing happend")}return(e,n)=>(a(),s(q,null,[p(u)?(a(),y(W,{key:0},{"modal-body":m(()=>[X,ee]),"modal-footer":m(()=>[t("div",{onClick:n[0]||(n[0]=i=>M(u)?u.value=!1:u=!1)},"ì•„ë‹ˆì˜¤"),t("div",{class:"yes",onClick:z},"ì˜ˆ")]),_:1})):N("",!0),p(f)?(a(),y($,{key:1},{"modal-body":m(()=>[c.nicknameConfirm==!0?(a(),s("p",ne,x(p(l).nickname)+"ë‹˜ ðŸ¥°",1)):(a(),s("p",te,x(p(l).nickname)+"ë‹˜ ðŸ˜¥",1)),c.nicknameConfirm==!0?(a(),s("p",oe,"ë‹‰ë„¤ìž„ë³€ê²½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!")):(a(),s("p",ie,"ë‹‰ë„¤ìž„ë³€ê²½ì€ 30ì¼ì— í•œ ë²ˆë§Œ ê°€ëŠ¥í•´ìš”."))]),"modal-footer":m(()=>[t("div",{onClick:n[1]||(n[1]=i=>M(f)?f.value=!1:f=!1)},"ë‹«ê¸°")]),_:1})):N("",!0),p(g)&&c.imageConfirm?(a(),y($,{key:2},{"modal-body":m(()=>[t("p",ae,x(p(l).nickname)+"ë‹˜ ðŸ¥°",1),se]),"modal-footer":m(()=>[t("div",{onClick:n[2]||(n[2]=i=>M(g)?g.value=!1:g=!1)},"ë‹«ê¸°")]),_:1})):N("",!0),t("div",le,[t("div",ce,[re,t("div",pe,[t("input",{onChange:n[3]||(n[3]=i=>U(i)),type:"file",accept:"image/*",ref_key:"fileInput",ref:V,class:"file-input"},null,544),C.value?(a(),s("div",ue,[t("img",{src:C.value,alt:"",class:"profile__image--img"},null,8,de),t("div",{class:"icon icon-camera",onClick:E})])):(a(),s("div",me,[t("div",{class:"icon icon-camera",onClick:E})]))]),t("div",_e,[fe,t("div",{class:F(["input-text__content-wrapper",{"input-text__content-wrapper--correct":o.isNicknameValid==!0,"input-text__content-wrapper--error input__message--appear":o.isNicknameValid==!1}])},[K(t("input",{class:"input-text__content",type:"text",maxlength:"10",spellcheck:"false",placeholder:p(w),"onUpdate:modelValue":n[4]||(n[4]=i=>o.inputNickname=i),onInput:n[5]||(n[5]=i=>P())},null,40,ge),[[Y,o.inputNickname]])],2),t("span",{class:F(["input__message",{"input__message--appear":o.inputMessage}]),textContent:o.inputMessage},null,10,ke)]),t("span",{class:"btn-semiround profile__btn--save",onClick:Z(L,["prevent"])},"ì €ìž¥í•˜ê¸°",8,he)])])],64))}},Ce=O(ve,[["__scopeId","data-v-1489ec30"]]);const ye={class:"content-wrap"},Me={__name:"Edit",setup(_){return(l,w)=>(a(),s("div",ye,[Q(Ce)]))}},Ee=O(Me,[["__scopeId","data-v-3ece87e9"]]);export{Ee as default};
